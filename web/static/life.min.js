var imgSrc,img,code,packageIdInput,html,bbcode,mdown,buildButton,startTime;$(window).load(function(){code=$("#badgeCode"),packageIdInput=$("#packageIdInput"),html=$("#html"),bbcode=$("#bbcode"),mdown=$("#mdown"),$("#buildButton").click(function(event){const packageId=packageIdInput.val();event.preventDefault(),buildButton=Ladda.create(this),packageId?null==imgSrc||img.attr("src").indexOf(packageId)<0?(resetUi(),startTime=(new Date).getTime(),fetchBadge(packageId)):showError("Again!?"):showError("Unfortunately I couldn't read your mind :)")}),$("#badgeDiv").append('<img id="badgeImg">'),img=$("#badgeImg"),img.hide().on("load",function(){imgSrc=img.attr("src");const packageId=packageIdInput.val(),storeUrl="https://play.google.com/store/apps/details?id="+packageId;img.fadeIn(1e3),code.fadeIn(1e3),html.val('<a href="'+storeUrl+'"><img src="'+imgSrc+"</a>"),bbcode.val("[url="+storeUrl+"][img]"+imgSrc+"[/img][/url]"),mdown.val("[![Badge]("+imgSrc+")]("+storeUrl+")"),ga("send","event","badge","loaded",packageId),ga("send","timing","badge","loaded",(new Date).getTime()-startTime,packageId),$('meta[property="og:image"]').attr("content",imgSrc),resetUi()}).on("error",function(){const packageId=packageIdInput.val();imgSrc=null,ga("send","event","badge","error",packageId),ga("send","timing","badge","error",(new Date).getTime()-startTime,packageId),showError("Aw, Snap! Check the package name and try again")});const carousel=$("#badgeCarousel");topApps.forEach(function(app,index){0!=index&&carousel.append('<div> <img data-lazy="'+location.protocol+badgePath+"?id="+app.id+'" class="badgeCarouselItem"> </div>')}),carousel.slick({infinite:!0,lazyLoad:"ondemand",fade:!0,autoplay:!0,arrows:!1,draggable:!1,swipe:!1,touchMove:!1,accessibility:!1,onAfterChange:function(slide,index){$('link[rel="shortcut icon"]').attr("href",topApps[index].image)},autoplaySpeed:7e3});const afterCopy=function(){showMessage("Code copied to clipboard, paste, paste, paste!",!1)},clipHtml=new ZeroClipboard($("#copy-html"));clipHtml.on("beforecopy",function(){ga("send","event","code","copy","html"),this.setText(html.val())}),clipHtml.on("aftercopy",afterCopy);const clipBB=new ZeroClipboard($("#copy-bbcode"));clipBB.on("beforecopy",function(){ga("send","event","code","copy","bbcode"),this.setText(bbcode.val())}),clipBB.on("aftercopy",afterCopy);const clipMD=new ZeroClipboard($("#copy-mdown"));clipMD.on("beforecopy",function(){ga("send","event","code","copy","mdown"),this.setText(mdown.val())}),clipMD.on("aftercopy",afterCopy),ZeroClipboard.on("error",function(){ga("send","event","code","copy","error"),code.find(".input-group").removeClass(),code.find(".input-group-btn").remove()}),$(".modal").on("shown.bs.modal",function(){ga("send","event","modal","shown",this.id)}).on("hidden.bs.modal",function(){ga("send","event","modal","hidden",this.id)})});var resetUi=function(){packageIdInput.attr("disabled",!1),buildButton.stop()},showError=function(error){resetUi(),showMessage(error,!0)},showMessage=function(message,isError){ga("send","event","message","show",message,isError?1:0),$.bootstrapGrowl(message,{ele:"#growlAnchor",type:isError?"danger":"success",align:"center",width:"auto",delay:4e3,allow_dismiss:!1,stackup_spacing:10})},fetchBadge=function(packageId){packageIdInput.attr("disabled",!0),buildButton.start(),code.fadeOut(250),img.fadeOut(250,function(){img.attr("src",location.protocol+badgePath+"?id="+packageId)})};